<!-- <p>====================</p>

<input type="text" [value] = "counter">
<br>
<button type = "button" (click) = "ClickIncrease()">+</button>
<br>
<button type = "button" (click) = "ClickDecrease()">-</button> -->
<div class="m-4 p-4 conten-bg" [formGroup]="rfUser">
    <div class="panel panel-primary">
        <div class="d-flex border-bottom align-item">
            <h3 class="p-2 mr-auto text-secondary main-text">TẠO MỚI NHÂN VIÊN</h3>
            <button type="submit" class="p-2 btn bg-secondary text-white" (click)="onSubmitForm()">Lưu</button>
            <button type="click" class="p-2 btn border-secondary" (click)="onCancelForm()">Hủy</button>
        </div>
        <div class="row panel-body">
            <div class="col-6">
                <div class="ava-container">
                    <input #uploadFile type="file" class="upload" (change)="updateAvatar($event)">
                    <div>
                        <img [src]="iconCamera" alt="" class="avatar icon-camera" (click)="uploadFile.click()">
                        <img [src]="user.avatar ? user.avatar : defaultLink" alt="Ảnh" class="avatar position-relative"
                            width="100" height="100" />
                    </div>
                </div>
                <br>
                <br>
                <input type="checkbox" formControlName="userCheck"> Hoạt động
                <br>
                <label for="">Mã nhân viên:</label>
                <br>
                <input type="text" class="form-control" formControlName="userNo">

                <label for="">Tên nhân viên: <span style="color: red">*</span></label>
                <br>
                <input type="text" class="form-control" formControlName="userName" (keyup)="name$.next($event.target.value)">
                <div>
                    {{formErrors?.userName}}
                </div>

            </div>
            <div class="col-6">
                <label for="">Email:</label>
                <br>
                <input type="text" class="form-control" formControlName="userEmail">
                <div>
                    {{formErrors?.userEmail}}
                </div>
                <label for="">Dân tộc:</label>
                <br>
                <input type="text" class="form-control" formControlName="userNation">
                <label for="">Tình trạng hôn nhân:</label>
                <br>
                <select class="form-control" formControlName="userMaritalStatus">
                    <option value="nam">Độc thân</option>
                    <option value="nu">Đã kết hôn</option>
                </select>

                <label for="">Ghi chú:</label>
                <br>
                <textarea rows="4" cols="50" class="form-control" formControlName="userDesc">
                        </textarea>
            </div>
        </div>
        <!-- <ng-template #workChild let-list="list" let-prefix="prefix">
            <ng-container *ngFor="let item of list; let i = index;">
                <div [formGroup]="rfUser.get(prefix + i)">
                    <div [formGroupName]="i">
                    <input type="text" formControlName="workName">
                    <input type="text" formControlName="workDesc">
                    </div>
                </div>
                <ng-container *ngIf="item.get('workItem')?.controls.length">
                    <ng-container
                        *ngTemplateOutlet="workChild; context:{ list: formatWorkArray(item.get('workItem')).controls, prefix: prefix + i + '.workItem.' }">
                    </ng-container>
                </ng-container>
            </ng-container>
        </ng-template>

        <ng-container
            *ngTemplateOutlet="workChild; context:{ list: formatWorkArray(rfUser.get('works')).controls , prefix: 'works.' }">
        </ng-container> -->

        <ng-template #recursiveList let-controls="controls" let-prefix="prefix" let-marLeft="marLeft">
            <ng-container *ngFor="let item of controls; let i = index">
                <ng-container class="tree-item" [formGroup]="rfUser.get(prefix + i)">
                    <tr>
                        <td>
                            <div [ngStyle]="{'margin-left': marLeft + 'px'}">
                                <input type="text" formControlName="workName">
                            </div>
                        </td>
                        <td><input type="text" formControlName="workDesc"></td>
                        <td>
                            <button class="fa fa-plus" aria-hidden="true" type="button"
                                (click)="addItem(controls)"></button>
                            <button class="fa fa-plus-square" aria-hidden="true" type="button"
                                (click)="addItem(formatWorkArray(item.get('workItem')))"></button>
                            <button class="fa fa-trash" aria-hidden="true" type="button"
                                (click)="deleteItem(controls, i)"></button>
                        </td>
                    </tr>
                </ng-container>
                <ng-container *ngIf="item.get('workItem')?.controls?.length">
                    <ng-container
                        *ngTemplateOutlet="recursiveList; context:{ controls: item.get('workItem').controls, prefix: prefix + i + '.workItem.', marLeft: marLeft + 15  }">
                    </ng-container>
                </ng-container>
            </ng-container>
        </ng-template>

        <table>
            <tr>
                <th>Tên công việc</th>
                <th>Mô tả</th>
                <th>Thao tác</th>
            </tr>
            <ng-container
                *ngTemplateOutlet="recursiveList; context:{ controls: formatWorkArray(rfUser.get('works')).controls, prefix: 'works.', marLeft: 0 }">
            </ng-container>
        </table>
    </div>
</div>