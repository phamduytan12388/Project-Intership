<div class="inner-content w-100 p-2">
    <div class="row mx-0 align-items">
        <div class="d-flex align-items-center">
            <h6 class="text-uppercase font-weight-bold primary-color mb-0">danh sách người dùng</h6>
        </div>
        <div class="mx-0 ml-auto d-flex">
            <div class="ml-auto d-flex flex-wrap w-100">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 d-flex form-inline pl-0 pr-0">
                    <div class="form-group align-items-start mr-3 py-1">
                        <div class="align-items-center mr-3 label pt-1">
                            <label class="mb-0">Nhóm người dùng</label>
                        </div>
                        <div>
                            <nz-select [(ngModel)]="filterModel.groupId" name="groupId" nzShowSearch nzAllowClear
                            (ngModelChange)="filter()"
                                nzPlaceHolder="-Tất cả (All)-">
                                <nz-option *ngFor="let item of userGroupData" [nzLabel]="item.name" [nzValue]="item.id">
                                </nz-option>
                            </nz-select>
                        </div>
                    </div>
                    <div class="search-area mx-1" nz-tooltip [nzTooltipTitle]="'Tìm theo tên, email'">
                        <nz-input-group class="search" nzSearch [nzAddOnAfter]="suffixIconButton">
                            <input type="text" nz-input (keyup)="searchTerm$.next($event.target.value)"
                                [value]="searchTerm$.value" [placeholder]="'Tìm theo tên, email'" />
                        </nz-input-group>
                        <ng-template #suffixIconButton>
                            <button nz-button nzType="primary" nzSearch><i nz-icon nzType="search"></i></button>
                        </ng-template>
                    </div>
                    <button nz-button nzType="primary" class="mx-1" [routerLink]="['/dashboard/manage-user/user/create']">Tạo mới</button>
                    <!-- <button nz-button nzType="primary" class="mx-1 " (click)="changeDeActive()">Vô hiệu hóa</button>
                    <button nz-button nzType="primary" class="mx-1" (click)="delete()">Xóa</button> -->
                    <button nz-button nzType="primary" class="ml-1" (click)="filter()">
                        <i class="fa fa-refresh" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="h-100 w-100 table-content pt-3">
        <nz-table #basicTable nzShowSizeChanger [nzFrontPagination]="false" [nzData]="userData" [nzLoading]="false"
            [nzTotal]="total" [(nzPageIndex)]="pageIndex" [(nzPageSize)]="pageSize"
            (nzPageIndexChange)="changePageIndex($event)" (nzPageSizeChange)="changPageSize($event)"
            [nzScroll]="{ x: '1150px' }">
            <thead>
                <tr>
                  <th  nzLeft="0px" class="text-center table-col-stt">
                    <label nz-checkbox [(ngModel)]="checkboxSelectAll" 
                    [ngModelOptions]="{standalone: true}"
                    (change)="onSelectAll($event.target.checked)" ></label>
                  </th>
                  <th  class="table-col-username">
                    <P class="mb-0">Tên đăng nhập</P>
                  </th>
                  <th  class="table-col-email">
                    <P class="mb-0 text-nowrap">Email</P>
                  </th>
                  <th class="table-col-fullname">
                    <P class="mb-0 text-nowrap">Họ và tên</P>
                  </th>
                  <th class="table-col-group">
                    <P class="mb-0 text-nowrap">Nhóm</P>
                  </th>
                  <th class="table-col-status text-center">
                    <P class="mb-0 text-nowrap">Trạng thái</P>
                  </th>
                  <th  nzRight="0px" class="text-center table-manipulation table-col-action" >
                    <P class="mb-0 text-nowrap">Thao tác</P>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of basicTable.data; let i = index">
                  <td nzLeft="0px" class="text-center">
                   <div class="d-flex justify-content-center">
                    <label nz-checkbox *ngIf="item?.id !== currentUser.userId" [(ngModel)]="item.checkboxSelected"  [ngModelOptions]="{standalone: true}"  (change)="changCheckAll()"></label>
                   </div>
                  </td>
                  <td><span class="hyperlink outline-none" [routerLink]="['/dashboard/manage-user/user/edit', item.id]">{{item?.userName}}</span>
                  </td>
                  <td><a  [href]="'mailto:' + item?.email">{{item?.email}}</a></td>
                  <td>{{item?.fullName}}</td>
                  <td>
                    <div class="d-flex align-items-center justify-content-between">
                      {{item?.group ? item?.group?.name : 'Chưa có nhóm'}}
                      <i class="fa fa-random fa-icon-random pointer" (click)="changeUserGroup(item)" aria-hidden="true" nz-tooltip
                      nzTooltipTitle="Thay đổi nhóm"></i>
                    </div>
                  </td>
                  <td>
                    <div class="d-flex justify-content-center">
                        <div class="text-center"
                        [class.status__label--active]="item?.isActive"
                        [class.status__label--inactive]="!item?.isActive">
                        {{getUserStatus(item?.isActive)}}
                      </div>

                    </div>
                  </td>
                  <td nzRight="0px">
                    <div class="d-flex justify-content-center align-items-center">
                      <i class="fa fa-pencil fa-icon-edit pointer mr-3 outline-none" aria-hidden="true" nz-tooltip
                        [routerLink]="['/dashboard/manage-user/user/edit', item?.id]" nzTooltipTitle="Sửa">
                      </i>
                     <ng-container >
                      <i class="fa fa-key fa-icon-key pointer mr-3" aria-hidden="true" nz-tooltip
                      nzTooltipTitle="Đặt lại mật khẩu" [class.invisible]="item?.id === currentUser.userId" (click)="createNewPassword(item)"></i>
                      <i class="fa fa-trash fa-icon-delete pointer mr-3" aria-hidden="true" nz-tooltip
                      [class.invisible]="item?.id === currentUser.userId"
                      nzTooltipTitle="Xóa" (click)="delete(item)"></i>
                      <div [class.invisible]="item?.id === currentUser.userId">
                        <div class="active-switch" (click)="changeActive(item)" aria-hidden="true" nz-tooltip
                        nzTooltipTitle="Thay đổi trạng thái"></div>
                        <nz-switch (ngModelChange)="changeActive(item)"
                        [ngModel]="item?.isActive === true" class="table-icon--switch" nzSize="small"></nz-switch>
  
                      </div>
                     </ng-container>
                    </div>
                  </td>
                </tr>
              </tbody>
        </nz-table>
    </div>